# 最小生成树

## 概念

> 最小权重生成树的简称

给定任意**联通无向图 G**, 对其遍历产生**生成树** 

> 生成树: 对连通图进行遍历, 经过的所有**边和点**形成一棵树, 称为**图的生成树**
>
> 连通图的生成树:
>
> 1. 连接图的所有顶点
> 2. 任意两顶点间有且仅有一条路径
>
> 简而言之, **连通图遍历**过程中的**边和点形成的树**是**该连通图的一个生成树**

**最小生成树: 权重之和最小的生成树**

$~$

**切分**

将图按点切分成两部分, 成为一个切分

> 也就是把图的点集, 一分为二
>
> 某图的点集: {A, B, C, D, E}
>
> 切分为: {A, B, C} 和 {D, E}

**横切边**

如果某条**边的两个顶点**分别属于**切分的两个部分**, 则该边称为**横切边**

> 横切边也就是连接两个部分的边

**切分定理**

给定一个图的切分, **所有横切边中权重最小的边**是最小生成树的边

给定切分形成的点集 A 和 B, 假定 A 和 B 内的最小生成树已经找到

为了形成 A 和 B 组成的图的最小生成树

显而易见的, 只需要找到 A 和 B 的最小横切边 e, 将其连接 A 和 B 各自的最小生成树, 就能形成最终的最小生成树

> 树的性质:
>
> 1. 连接树的任意两个结点, 形成一个环
> 2. 删除任意一条边, 生成两棵树

1. 为什么是一条边?

   因为只需要一条边就能将两颗树连接起来, 如果连接的边多于一条, 那么就会形成环, 结果就不是一棵树

2. 为什么是最小的横切边?

   因为最小生成树要求权重之和最小, A 和 B 的最小生成树已经确定, 那么就需要连接两颗最小生成树的横切边权重最小

**证:** 反证法

假设选择的横切边 $e'$ 权重不是最小的, 形成一颗最小生成树

设权重最小的横切边是 $e$

将 $e$ 加入最小生成树中, 形成环

去掉边 $e'$ , 得到一颗新的最小生成树, 其权重之和更小, 产生矛盾

所以需要选择**所有横切边中权重最小的边**



## 算法

### Kruskal 

> $O(m \log m)$ 稀疏图
>
> 贪心

**思路:**

1. 将所有边按权重排序

2. 按权重从小到大枚举每条边 $u \xrightarrow w v$

   若 $u, v$  不连通, 则将该边加入**最小生成树**中

**代码实现**

```C++
N: 点的数量
M: 边的数量

struct Edge
{
    int u, v;
    int w;
    bool operator<(const Edge &b)
    {
        return w < b.w;
    }
}edges[M];

int p[N];
int n, m;

int find(int x)
{
    if(p[x] != x) p[x] = find(p[x]);
    return p[x];
}

int kruskal()
{
    sort(edges, edges + m);
    for(int i = 1; i <= n; i++) p[i] = i;
    
    int cnt = 0, res = 0;
    for(int i = 0; i < m; i++)
    {
        int a = edges[i].u, b = edges[i].v, w = edges[i].w;
        a = find(a), b = find(b);
        if(a != b)
        {
            p[a] = b;
            res += w;
            cnt++;
        }
    }
    if(cnt < n - 1) return INF;
    return res;
}

int main()
{
    cin >> n >> m;
    for(int i = 0; i < m; i++)
    {
        int a, b, w;
        cin >> a >> b >> w;
        edges[i] = {a, b, w};
    }
    
    int t = kruskal();
    
    if(t == INF) cout << "impossible" << endl;
    else cout << t << endl;
    
    return 0;
}
```

## 题库

[连接所有点的最小费用](https://leetcode.cn/problems/min-cost-to-connect-all-points/)	稠密图