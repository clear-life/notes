# 操作系统

### 进程与线程区别

|      | 进程                         | 线程                             |
| ---- | ---------------------------- | -------------------------------- |
| 作用 | **资源分配**基本单位         | **CPU 调度**基本单位             |
| 资源 | **独立内存空间**             | **共享同一内存**, 独享寄存器和栈 |
| 开销 | 创建销毁切换**开销大**       | 创建销毁切换**开销少**           |
| 调试 | **简单**                     | **复杂**                         |
| 影响 | 不会相互影响, 多考虑**通信** | **会相互影响**, 多考虑**同步**   |

### 进程间通信方式

**主机间**

socket 通信

**主机内**

**1. 有名管道, 无名管道**

**2. 消息队列**

**3. 共享内存**

映射到同一物理内存

**4. 信号量**

信号量 cnt 表示资源的数量

PV 操作

* P

  ```C++
  // 进入共享资源前
  cnt--;
  if(cnt >= 0)
  	继续执行
  else
  	进程阻塞
  ```

* V

  ```C++
  // cnt 的绝对值标识被阻塞的进程数
  // 离开共享资源后 
  cnt++;
  if(cnt <= 0)	// 说明之前有进程被阻塞
      唤醒进程
  else
      没有进程被阻塞
  ```

**互斥实现**

信号量设为 1, 表明同一时刻只有一个进程可以访问该资源

```C++
// 进程
P();	// 申请资源
...		// 访问临界区资源
V();	// 释放资源
```

**同步实现**

信号量设为 0 

```C++
// 进程 A
...		// 生成数据
V();	// 生产一份资源

// 进程 B
P();	// 申请一份资源
...		// 消费一份资源
```

**5. 信号**

相当于控制信号