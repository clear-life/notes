# 第1章 C++并发入门

## 本章内容

* 什么是**并发**和**多线程**
* 为什么要用**并发**和**多线程**
* C++ 与并发
* C++ 多线程的 `hello world`

## 1. 什么是并发

### 概念

并发: 多个程序**同时且独立运行**

硬件并发: 多个 CPU, 多核 CPU

> CPU: 控制单元, 运算单元 ALU, 存储单元
>
> 1个核(core) : 1个控制单元, 1个运算单元 ALU

### 并发方式

多进程与多线程

### 并发与并行

本质一样

> 通常来说, 并发指**时间段**, 并行指**时间点**, 但可以都看作并发

* 并发侧重概念
* 并行侧重实际

## 2. 为什么用并发

**分离关注点**与**性能提升**

### 分离关注点

归类相关代码, 隔离无关代码

例: 游戏程序中, 一个线程只负责**界面管理**, 一个线程只负责 **`gameplay`**

### 性能提升

提高性能

* **任务并行**

  **单一任务分解为多个部分**, 各自并行运行

* **数据并行**

  同一方式**并行处理多份数据**

### 并发的代价

* 并发代码**难理解**

  编写和维护难, 开发周期长

* **线程资源**

* **线程切换**

## 3. C++ 与并发

### 新标准

* 规定内存模型
* 线程管理
* 锁
* 线程同步
* 原子操作
* 并行算法函数

## 4. C++ 并发入门

`std::thread t(fun);` 启动并管理线程, 线程执行 `fun` 函数

`t.join();` 等待线程执行完

```C++
#include <iostream>
#include <thread>

void fun()
{
    std::cout << "Hello Concurrent World!" << std::endl;
}

int main()
{
    std::thread t(fun);
    t.join();
}
```

## 总结

* 并发作用: **分离关注点**和**性能提升**
